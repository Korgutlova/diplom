<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Результаты</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.7/dist/css/bootstrap-select.min.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.7/dist/js/bootstrap-select.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.7/dist/js/i18n/defaults-*.min.js"></script>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" >Аналитика результатов</a>
        </div>
        <ul class="nav navbar-nav">
            <li class="active"><a href="#">Результаты</a></li>
            <li ><a href="{% url 'fls:simjury' %}">Схожесть жюри</a></li>
        </ul>
    </div>
</nav>
<div class="container" style="margin-top: 50px">
    <div class="row">
        <div class="col-sm-4">
            <label for="comp">Выберите конкурс</label>
            <br>
            <select id="comp" name="comp" class="selectpicker">
                {% for comp in comps %}
                    <option value={{ comp.id }}>{{ comp.name }}</option>
                {% endfor %}
            </select>
            <br>
            <br>
            <label for="type">Выберите метод:</label>
            <br>
            <select name="type" id="type" class="selectpicker">
                <option value="all" selected>Все</option>
                <option value="1">Абсолютная оценка</option>
                <option value="3">Сравнение параметров</option>
                <option value="5">Оценка по формуле</option>
            </select>
            <br>
            <br>
            <label for="jury">Жюри:</label>
            <br>
            <select id="jury" name="jury" class="selectpicker">
                <option name="abs" value="all" selected>Все</option>
                {% for jury in jurys %}
                    <option value={{ jury.id }}>{{ jury }}</option>
                {% endfor %}
            </select>
            {#    <button class="btn btn-success" id="send">Посмотреть</button>#}

            <br>
        </div>
        <div class="col-sm-8">
            <table id="values" class="table table-striped table-bordered">

            </table>
        </div>
    </div>
</div>


</body>
<script>

    var f = function () {
        type = $('#type').val();
        comp_id = $('#comp').val();
        jury = $('#jury').val();
        $.ajax({
            url: '/fls/common_values/',
            type: 'get',
            data: {'comp': comp_id, 'type': type, 'jury': jury},
            dataType: 'json',
            success: function (data) {
                $("#values").html(data.est)
            },
            error: function () {
                alert("error");
            },
            complete: function (data) {

            }
        })

    };

    const disable_jury = function () {
        select_type = $('#type');
        select_jury = $('#jury');
        if (select_type.val() == 'all' || select_type.val() == '5') {
            select_jury.val('all');
            select_jury.prop('disabled', true);
        }
        else {
            select_jury.prop('disabled', false);
        }
    };
    select_type = $('#type');
    select_type.change(disable_jury);
    select = $('select');
    select.selectpicker();
    {#$('#send').click(f);#}
    select.change(f);
    $(document).ready(f);
    $(document).ready(disable_jury)


</script>
</html>